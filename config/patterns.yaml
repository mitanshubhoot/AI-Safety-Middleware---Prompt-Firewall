# Detection patterns for sensitive data
patterns:
  # API Keys and Secrets
  api_keys:
    - name: openai_api_key
      pattern: 'sk-[A-Za-z0-9]{48}'
      description: "OpenAI API Key"
      severity: critical
    - name: aws_access_key
      pattern: 'AKIA[0-9A-Z]{16}'
      description: "AWS Access Key ID"
      severity: critical
    - name: aws_secret_key
      pattern: 'aws_secret_access_key\s*=\s*[A-Za-z0-9/+=]{40}'
      description: "AWS Secret Access Key"
      severity: critical
    - name: gcp_api_key
      pattern: 'AIza[0-9A-Za-z_-]{35}'
      description: "Google Cloud API Key"
      severity: critical
    - name: azure_api_key
      pattern: '[0-9a-f]{32}'
      description: "Azure API Key"
      severity: high
    - name: github_token
      pattern: 'gh[pousr]_[A-Za-z0-9]{36,255}'
      description: "GitHub Token"
      severity: critical
    - name: slack_token
      pattern: 'xox[baprs]-[0-9]{10,13}-[0-9]{10,13}-[A-Za-z0-9]{24,32}'
      description: "Slack Token"
      severity: high
    - name: stripe_api_key
      pattern: 'sk_live_[0-9a-zA-Z]{24,}'
      description: "Stripe Live API Key"
      severity: critical
    - name: generic_api_key
      pattern: 'api[_-]?key\s*[:=]\s*["\']?[A-Za-z0-9_-]{16,}["\']?'
      description: "Generic API Key Pattern"
      severity: medium

  # Private Keys and Certificates
  private_keys:
    - name: rsa_private_key
      pattern: '-----BEGIN RSA PRIVATE KEY-----'
      description: "RSA Private Key"
      severity: critical
    - name: openssh_private_key
      pattern: '-----BEGIN OPENSSH PRIVATE KEY-----'
      description: "OpenSSH Private Key"
      severity: critical
    - name: dsa_private_key
      pattern: '-----BEGIN DSA PRIVATE KEY-----'
      description: "DSA Private Key"
      severity: critical
    - name: ec_private_key
      pattern: '-----BEGIN EC PRIVATE KEY-----'
      description: "EC Private Key"
      severity: critical
    - name: pgp_private_key
      pattern: '-----BEGIN PGP PRIVATE KEY BLOCK-----'
      description: "PGP Private Key"
      severity: critical

  # Authentication Tokens
  tokens:
    - name: jwt_token
      pattern: 'eyJ[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}\.[A-Za-z0-9_-]{10,}'
      description: "JWT Token"
      severity: high
    - name: bearer_token
      pattern: 'Bearer\s+[A-Za-z0-9_-]{20,}'
      description: "Bearer Token"
      severity: high
    - name: oauth_token
      pattern: 'oauth_token\s*[:=]\s*["\']?[A-Za-z0-9_-]{20,}["\']?'
      description: "OAuth Token"
      severity: high

  # PII - Personally Identifiable Information
  pii:
    - name: ssn
      pattern: '\b\d{3}-\d{2}-\d{4}\b'
      description: "Social Security Number"
      severity: critical
    - name: credit_card
      pattern: '\b(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|6(?:011|5[0-9]{2})[0-9]{12}|(?:2131|1800|35\d{3})\d{11})\b'
      description: "Credit Card Number"
      severity: critical
    - name: email
      pattern: '\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b'
      description: "Email Address"
      severity: medium
    - name: phone_us
      pattern: '\b(?:\+?1[-.]?)?\(?([0-9]{3})\)?[-.]?([0-9]{3})[-.]?([0-9]{4})\b'
      description: "US Phone Number"
      severity: medium
    - name: phone_international
      pattern: '\+[1-9]\d{1,14}'
      description: "International Phone Number"
      severity: medium

  # Network and Infrastructure
  network:
    - name: ipv4_private
      pattern: '\b(?:10\.\d{1,3}\.\d{1,3}\.\d{1,3}|172\.(?:1[6-9]|2\d|3[0-1])\.\d{1,3}\.\d{1,3}|192\.168\.\d{1,3}\.\d{1,3})\b'
      description: "Private IPv4 Address"
      severity: low
    - name: ipv4_public
      pattern: '\b(?!10\.|172\.(?:1[6-9]|2[0-9]|3[0-1])\.|192\.168\.)(?:[0-9]{1,3}\.){3}[0-9]{1,3}\b'
      description: "Public IPv4 Address"
      severity: medium
    - name: internal_url
      pattern: 'https?://(?:localhost|127\.0\.0\.1|10\.\d{1,3}\.\d{1,3}\.\d{1,3}|172\.(?:1[6-9]|2\d|3[0-1])\.\d{1,3}\.\d{1,3}|192\.168\.\d{1,3}\.\d{1,3})'
      description: "Internal URL"
      severity: medium

  # Database Connection Strings
  database:
    - name: connection_string
      pattern: '(?:postgres|mysql|mongodb|redis)://[^\s]+'
      description: "Database Connection String"
      severity: critical
    - name: jdbc_url
      pattern: 'jdbc:[^\s]+'
      description: "JDBC Connection String"
      severity: high

  # Passwords (context-aware)
  passwords:
    - name: password_assignment
      pattern: 'password\s*[:=]\s*["\']?[^\s"\']{8,}["\']?'
      description: "Password Assignment"
      severity: high
    - name: password_field
      pattern: '(?:pwd|passwd|password)\s*[:=]\s*["\']?[A-Za-z0-9!@#$%^&*()_+\-=\[\]{};:,.<>?]{8,}["\']?'
      description: "Password Field"
      severity: high

# Context-aware patterns (require surrounding text analysis)
contextual_patterns:
  - trigger: "the password is"
    severity: critical
  - trigger: "api key:"
    severity: critical
  - trigger: "secret:"
    severity: high
  - trigger: "token:"
    severity: high
  - trigger: "credentials:"
    severity: high
  - trigger: "private key:"
    severity: critical

# Pattern categories for reporting
categories:
  critical: ["api_keys", "private_keys", "database", "ssn", "credit_card"]
  high: ["tokens", "passwords"]
  medium: ["pii", "network"]
  low: []
